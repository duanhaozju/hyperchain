syntax = "proto3";

// Dispatcher response for Message distribute.
service Dispatcher {
    rpc Register(stream Message) returns(stream Message) {}
}

// Message is the wrapper of specific message
message Message {
    uint64 id       = 1;
    Type type       = 2; // The basic message type.
    FROM from       = 3; // Define where the message come from.
    Event event     = 4; // Define the event type.
    bool ok         = 5; // used for response
    bytes payload   = 6; // The message body.
}

// RegisterMessage used by service component to connect to Dispatcher.
message RegisterMessage {
    string address      = 1;
    string port         = 2;
    string namespace    = 3;
    bytes payload       = 4; // retained field
}

enum Type {
    UNDEFINED = 0;
    REGISTER = 1;
    DISPATCH = 2;
    ADMIN = 3;
    RESPONSE = 4;
}

enum FROM {
    APISERVER = 0;
    CONSENSUS = 1;
    EXECUTOR  = 2;
    NETWORK   = 3;
    EVENTHUB  = 4;
    ADMINISTRATOR = 5;
}

enum Event {
    //1.APIServer event

    //2.Consensus event
    InformPrimaryEvent = 0;
    VCResetEvent = 1;
    BroadcastConsensusEvent = 3;
    TxUniqueCastEvent = 4;
    CommitEvent = 5;
    ChainSyncReqEvent = 6;
    BroadcastNewPeerEvent = 7;
    BroadcastDelPeerEvent = 8;
    UpdateRoutingTableEvent = 9;
    FilterSystemStatusEvent = 10;
    //3.Executor event

    ExecutorToP2PEvent = 11;
    ExecutorToConsensusEvent = 12;
    //4.Network event

    //5.Eventhub event

    //6.Administrator event
}